<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>연합뉴스TV RSS 뉴스</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .news-item { margin-bottom: 20px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
    .news-item img { max-width: 100%; height: auto; display: block; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>연합뉴스TV 뉴스</h1>
  <select id="category">
    <option value="latest">최신</option>
    <option value="politics">정치</option>
    <option value="economy">경제</option>
    <option value="society">사회</option>
    <option value="local">지역</option>
    <option value="international">세계</option>
    <option value="culture">문화·연예</option>
    <option value="sports">스포츠</option>
    <option value="weather">날씨</option>
  </select>
  <div id="news"></div>

  <script>
    const workerURL = 'https://webnews.rock0424.workers.dev/'; // 여기에 Worker URL 넣기
    const newsContainer = document.getElementById('news');
    const categorySelect = document.getElementById('category');

    async function loadNews(category) {
      newsContainer.innerHTML = '로딩 중...';
      try {
        const res = await fetch(workerURL + '?category=' + category);
        const text = await res.text();
        const parser = new DOMParser();
        const xml = parser.parseFromString(text, "application/xml");
        const items = xml.querySelectorAll('item');
        newsContainer.innerHTML = '';

        items.forEach(item => {
          const title = item.querySelector('title')?.textContent || '';
          const link = item.querySelector('link')?.textContent || '#';
          const description = item.querySelector('description')?.textContent || '';
          const image = item.querySelector('enclosure')?.getAttribute('url') || '';

          const div = document.createElement('div');
          div.className = 'news-item';
          div.innerHTML = `
            <a href="${link}" target="_blank"><h3>${title}</h3></a>
            ${image ? `<img src="${image}">` : ''}
            <p>${description}</p>
          `;
          newsContainer.appendChild(div);
        });
      } catch (err) {
        newsContainer.innerHTML = '뉴스를 불러오는데 실패했습니다.';
        console.error(err);
      }
    }

    categorySelect.addEventListener('change', () => {
      loadNews(categorySelect.value);
    });

    loadNews('latest'); // 초기 로딩
  </script>
</body>
</html>
